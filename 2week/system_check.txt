#!/bin/bash

# =========================
# System Check Script
# OS: Rocky Linux 9.7
# =========================

# 로그 디렉터리
LOG_DIR="/var/log/system_check"
mkdir -p $LOG_DIR

# 날짜
DATE=$(date +"%Y-%m-%d %H:%M:%S")
LOG_FILE="$LOG_DIR/system_check_$(date +%Y%m%d).log"

echo "==============================" >> $LOG_FILE
echo "System Check Time : $DATE" >> $LOG_FILE
echo "==============================" >> $LOG_FILE

# 1. 디스크 사용량
echo "[Disk Usage]" >> $LOG_FILE
df -h >> $LOG_FILE
echo "" >> $LOG_FILE

# 2. 메모리 사용량
echo "[Memory Usage]" >> $LOG_FILE
free -h >> $LOG_FILE
echo "" >> $LOG_FILE

# 3. CPU Load
echo "[CPU Load Average]" >> $LOG_FILE
uptime >> $LOG_FILE
echo "" >> $LOG_FILE

# 4. 상위 메모리 사용 프로세스 TOP 5
echo "[Top 5 Memory Processes]" >> $LOG_FILE
ps -eo pid,comm,%mem,%cpu --sort=-%mem | head -n 6 >> $LOG_FILE
echo "" >> $LOG_FILE

echo "System check completed." >> $LOG_FILE
